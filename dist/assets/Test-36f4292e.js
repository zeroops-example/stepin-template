import{d as U,r as _,v as C,x as Q,y as N,o as O,z as X,c as E,j as R,f as a,A as x,k as g,C as Y,g as W,w as k,i as H,T as Z,D as tt,B as F,p as et,l as ot,q as J,E as st,G as nt,e as V,H as P}from"./index-6f18c032.js";const lt=w=>(et("data-v-7d02193c"),w=w(),ot(),w),it={class:"guider-content"},at=lt(()=>a("h1",null,"第一步",-1)),rt={class:"guider-footer flex justify-between w-full"},ct=U({__name:"Guider",props:{current:[HTMLElement,Object,String],options:{required:!0,type:Array},show:Boolean},emits:["close","update:show","update:current"],setup(w,{emit:d}){const l=w,h=_(0),$=C({get(){return l.current&&(h.value=l.options.findIndex(t=>t.target===l.current)),h.value},set(t){const o=l.options[t];o?(h.value=t,d("update:current",o.target)):(h.value=0,d("close"),d("update:current",l.options[0].target),d("update:show",!1))}}),n=_(),m=_(l.show),e=Q({width:0,height:0,left:0,top:0,right:0,bottom:0}),b=C(()=>{var o;const t=l.current??((o=l.options[h.value])==null?void 0:o.target);if(t)return typeof t=="string"?document.querySelector(t):t instanceof HTMLElement?t:t.$el}),v=C(()=>{const{offsetWidth:t,offsetHeight:o}=n.value||{offsetWidth:0,offsetHeight:0},{left:i,top:f,right:p,bottom:c,height:y,width:u}=e,s={main:"horizontal",sub:"vertical",horizontal:"left",vertical:"top"};return Math.max(i,p)>=Math.max(f,c)?(s.main="horizontal",s.sub="vertical",s.horizontal=i>p?"left":"right",f+y/2<o/2&&c+y/2>o/2?s.vertical="top":f+y/2>o/2&&c+y/2<o/2?s.vertical="bottom":s.vertical="center"):(s.main="vertical",s.sub="horizontal",s.vertical=f>c?"top":"bottom",i+u/2<t/2&&p+u/2>t/2?s.horizontal="left":i+u/2>t/2&&p+u/2<t/2?s.horizontal="right":s.horizontal="center"),s}),B=C(()=>{var A,G,L,M,q,D;const t={left:0,top:0};if(!l.show||!n.value||!m.value)return t;const{top:o,left:i,right:f,bottom:p,height:c,width:y}=e,u=v.value,s=u[u.main],I=u[u.sub],j=10,K=(u.main==="horizontal"?(A=n.value)==null?void 0:A.offsetWidth:(G=n.value)==null?void 0:G.offsetHeight)??0;return t[s]=e[s]-K-j,s==="right"?t.left=i+y+j:s==="bottom"&&(t.top=o+c+j),I==="center"?u.main==="horizontal"?t.top=o+c/2-(((L=n.value)==null?void 0:L.offsetHeight)??0)/2:t.left=i+y/2-(((M=n.value)==null?void 0:M.offsetWidth)??0)/2:t[I]=e[I],t.left===void 0&&(t.left=window.innerWidth-t.right-((q=n.value)==null?void 0:q.offsetWidth)),t.top===void 0&&(t.top=window.innerHeight-t.bottom-((D=n.value)==null?void 0:D.offsetHeight)),t}),z=C(()=>{const t={left:-16,top:-16};if(!l.show||!n.value||!m.value)return t;const o=v.value,i=o[o.main],f=o[o.sub],{offsetHeight:p=0,offsetWidth:c=0}=n.value??{};return i==="left"?t.left=(c??0)-4:i==="top"&&(t.top=(p??0)-4),o.main==="horizontal"&&(f==="center"?t.top=p/2-10:f==="bottom"?t.top=p-e.height/2-10:t.top=e.height/2-10),o.main==="vertical"&&(f==="center"?t.left=c/2-10:f==="right"?t.left=c-e.width/2-10:t.left=e.width/2-10),t});function r(){const t=b.value;if(!t)return;const o=tt(t);e.left=o[0],e.top=o[1],e.width=t.offsetWidth,e.height=t.offsetHeight,e.right=window.innerWidth-e.width-e.left,e.bottom=window.innerHeight-e.height-e.top}N(()=>[b.value,l.show],r),N(()=>l.show,t=>{m.value=t},{flush:"post"}),O(()=>{window.addEventListener("resize",r)}),X(()=>{window.removeEventListener("resize",r)});function S(){$.value+=1}function T(){d("close"),d("update:show",!1)}return(t,o)=>{const i=F;return E(),R(Z,{to:"body"},[a("div",{class:"guider",style:x(`display: ${w.show?"static":"none"}`)},[a("div",{class:"guider-left",style:x(`border-left: ${e.left-2}px solid rgba(0, 0, 0, 0.25);`)},null,4),a("div",{class:"guider-top",style:x(`left: ${e.left-2}px; width: ${e.width+4}px; border-top: ${e.top-2}px solid rgba(0, 0, 0, 0.25);`)},null,4),a("div",{class:"guider-right",style:x(`left: ${e.left+e.width+2}px; background-color: rgba(0, 0, 0, 0.25)`)},null,4),a("div",{class:"guider-bottom",style:x(`left: ${e.left-2}px; width: ${e.width+4}px; top: ${e.top+e.height+2}px`)},null,4),a("div",{ref_key:"doc",ref:n,class:"guider-doc flex flex-col justify-between rounded-md",style:x(`left: ${g(B).left}px;top:${g(B).top}px`)},[a("div",{class:"arrow",style:x(`left: ${g(z).left}px; top: ${g(z).top}px; border-${g(v)[g(v).main]}-color: white`)},null,4),a("div",it,[at,a("div",null,[Y(t.$slots,"default",{},void 0,!0)])]),a("div",rt,[W(i,{onClick:T},{default:k(()=>[H("关闭")]),_:1}),W(i,{type:"primary",onClick:S},{default:k(()=>[H("下一步")]),_:1})])],4)],4)])}}});const ut=J(ct,[["__scopeId","data-v-7d02193c"]]),ft={class:"test-page"},dt=U({__name:"Test",setup(w){const d=st();d.setAuthorities(["personal:edit","personal:remove"]);const l=d.useAuth("personal:edit",z=>console.log("hi, "+z)),h=()=>console.log("say hi");l("jack");const $=_(),n=_(),m=_();let e=[];const b=_(),v=_(!1);function B(){console.log("hello")}return O(()=>{b.value=$.value,e.push({target:$.value,doc:m.value},{target:n.value,doc:m.value})}),(z,r)=>{const S=F,T=nt("auth");return E(),V("div",ft,[a("div",null,[P((E(),R(S,{onClick:r[0]||(r[0]=t=>v.value=!0)},{default:k(()=>[H("新手引导1")]),_:1})),[[T,"personal:edit"]]),W(S,{class:"btn1",ref_key:"btn1",ref:$,type:"primary",onClick:r[1]||(r[1]=t=>b.value=n.value)},{default:k(()=>[H("button 1")]),_:1},512),W(S,{class:"btn2",ref_key:"btn2",ref:n,type:"primary",onClick:r[2]||(r[2]=t=>b.value=$.value)},{default:k(()=>[H("button 2")]),_:1},512),P((E(),V("span",{onClick:h,class:"ml-40 p-2"},[H("test")])),[[T,"hello"]])]),W(g(ut),{current:b.value,options:g(e),show:v.value,"onUpdate:show":r[3]||(r[3]=t=>v.value=t)},{default:k(()=>[a("div",{ref_key:"doc",ref:m,onClick:B},"功能指引",512)]),_:1},8,["current","options","show"])])}}});const ht=J(dt,[["__scopeId","data-v-0a39d9f4"]]);export{ht as default};
//# sourceMappingURL=Test-36f4292e.js.map
